# OkÃª Sports - Contexto do Projeto

**Plataforma SaaS para gestÃ£o de inscriÃ§Ãµes e eventos esportivos**

**Status:** ğŸ“‹ Planejamento completo | ğŸš€ Pronto para iniciar desenvolvimento
**Ãšltima atualizaÃ§Ã£o:** 31/10/2025
**VersÃ£o do planejamento:** 2.0

---

## ğŸ¯ VISÃƒO GERAL

### O que Ã©?
OkÃª Sports Ã© uma **plataforma marketplace bilateral** que conecta organizadores de eventos esportivos com participantes (atletas), facilitando inscriÃ§Ãµes, pagamentos e gestÃ£o de eventos.

### Diferencial Principal
- **Modelo Marketplace:** Dinheiro vai DIRETO para o organizador via split payment
- **Zero risco financeiro:** Plataforma nÃ£o retÃ©m valores
- **Mais barato:** Taxa de 10% vs 12% da concorrÃªncia (Ticket Sports)
- **Repasse rÃ¡pido:** PIX em D+0, sem taxa de repasse

### Etimologia do Nome
**OkÃª** = "Porta" ou "Entrada" em Tupi-Guarani â†’ perfeito para plataforma de acesso a eventos

---

## ğŸ’° MODELO DE NEGÃ“CIO

### MonetizaÃ§Ã£o (Marketplace Bilateral)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PARTICIPANTE                                â”‚
â”‚ InscriÃ§Ã£o: R$ 80,00                         â”‚
â”‚ Taxa OkÃª Sports: R$ 8,00 (10%)              â”‚
â”‚ TOTAL PAGA: R$ 88,00                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ (Mercado Pago)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SPLIT AUTOMÃTICO                            â”‚
â”‚ â€¢ Organizador: R$ 79,13 (D+0 para PIX)     â”‚
â”‚ â€¢ OkÃª Sports: R$ 8,00                       â”‚
â”‚ â€¢ Taxa Gateway: R$ 0,87 (paga pelo org)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Planos (Freemium)
| Plano | Mensalidade | Taxa Part. | Limite |
|-------|-------------|------------|--------|
| **FREE** | R$ 0 | 12% | 1 evento, 100 insc/mÃªs |
| **STARTER** | R$ 49 | 10% | 3 eventos, 500 insc/mÃªs |
| **PRO** | R$ 149 | 9% | Ilimitado |
| **ENTERPRISE** | Consulta | 7-8% | Custom |

---

## ğŸ›  STACK TECNOLÃ“GICO DEFINIDO

### Frontend
- **Framework:** Next.js 14+ (App Router, Server Components)
- **Linguagem:** TypeScript
- **Styling:** Tailwind CSS + shadcn/ui
- **FormulÃ¡rios:** React Hook Form + Zod
- **Estado:** Zustand ou React Query
- **GrÃ¡ficos:** Recharts

### Backend
- **Runtime:** Next.js API Routes (MVP) â†’ Node.js/Express (escala)
- **Linguagem:** TypeScript
- **Banco de dados:** PostgreSQL 14+ (Neon/Supabase para MVP)
- **ORM:** Prisma
- **Cache:** Redis (Upstash)
- **Queue:** Bull (se necessÃ¡rio)

### Pagamentos
- **Gateway:** Mercado Pago Marketplace (OAuth + Split Payment)
- **Backup:** Stripe Connect (futuro)
- **Formas:** PIX, CartÃ£o (atÃ© 12x), Boleto

### Email
- **Provider:** Resend
- **Templates:** React Email

### Storage
- **Imagens/Arquivos:** AWS S3 ou Cloudflare R2

### Deploy e Infra
- **Frontend:** Vercel
- **Backend:** Railway ou Render
- **Monitoramento:** Sentry + Uptime Robot
- **Analytics:** PostHog ou Mixpanel

### ğŸš« NÃƒO usar no MVP
- Mobile nativo (React Native/Flutter) - web responsivo primeiro
- MicroserviÃ§os - monolito modular
- GraphQL - REST Ã© suficiente
- Docker/K8s - overkill para MVP

---

## ğŸ— ARQUITETURA

### Modelo de Dados (Multi-tenant)
```
User (organizador)
  â”œâ”€ mpConnected: boolean
  â”œâ”€ mpAccessToken: string (encrypted)
  â”œâ”€ mpRefreshToken: string (encrypted)
  â””â”€ events[]
      â”œâ”€ Event
      â”‚   â”œâ”€ batches[] (lotes)
      â”‚   â”œâ”€ registrations[] (inscriÃ§Ãµes)
      â”‚   â””â”€ products[] (produtos extras)
      â””â”€ Registration
          â”œâ”€ paymentId: string (MP)
          â”œâ”€ paymentStatus: enum
          â””â”€ participant data
```

### Fluxo OAuth (Marketplace)
```
1. Organizador cadastra â†’ nossa plataforma (email + senha)
2. Clica "Conectar Mercado Pago"
3. Redirect â†’ OAuth Mercado Pago
4. Organizador autoriza â†’ MP retorna access_token
5. Salvamos token (CRIPTOGRAFADO) â†’ banco
6. Organizador pode criar eventos
7. Pagamentos vÃ£o direto para conta MP dele
8. Split automÃ¡tico â†’ OkÃª Sports recebe %
```

### SeguranÃ§a
- **AutenticaÃ§Ã£o:** JWT (access + refresh token)
- **Criptografia:** tokens via crypto (AES-256)
- **Rate Limiting:** 100 req/15min por IP
- **SanitizaÃ§Ã£o:** Zod validation em todas inputs
- **LGPD:** desde M1 (termos, privacidade, consentimento)

---

## ğŸ“‹ STATUS ATUAL DO PROJETO

### âœ… ConcluÃ­do
- [x] Planejamento estratÃ©gico completo
- [x] Modelo de negÃ³cio definido e validado
- [x] Stack tecnolÃ³gico escolhido
- [x] Milestones detalhados (M0-M16)
- [x] Tasks quebradas (91 SP para MVP)
- [x] Scripts de setup GitHub prontos

### ğŸš§ Em Andamento
- [ ] Executando `./github-setup.sh` (criando labels, milestones, issues)

### ğŸ“… PrÃ³ximos Passos
1. **M0: ValidaÃ§Ã£o de Mercado** (1 semana)
   - Entrevistar 10-15 organizadores
   - Validar modelo marketplace
   - DecisÃ£o Go/No-Go

2. **M1-M3: Super MVP** (3-4 semanas)
   - Setup projeto
   - OAuth Mercado Pago
   - PIX + CartÃ£o (parcelamento)
   - Landing page pÃºblica
   - Dashboard organizador
   - Emails transacionais

3. **CHECKPOINT 1:** Validar com 3-5 organizadores reais

---

## ğŸ“ CONVENÃ‡Ã•ES DE CÃ“DIGO

### Branches
```
feature/M1.1-setup-projeto
fix/payment-webhook-error
refactor/auth-middleware
docs/update-readme
```

### Commits (Conventional Commits)
```
feat(auth): implementar login com JWT
fix(payment): corrigir validaÃ§Ã£o de webhook
refactor(db): otimizar query de inscriÃ§Ãµes
docs(readme): adicionar instruÃ§Ãµes de setup
test(e2e): adicionar teste de checkout
```

### Estrutura de Pastas
```
src/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/            # Grupo de rotas: login, register
â”‚   â”œâ”€â”€ (dashboard)/       # Grupo de rotas: Ã¡rea do organizador
â”‚   â”œâ”€â”€ (public)/          # Landing pages pÃºblicas
â”‚   â””â”€â”€ api/               # API routes
â”‚       â”œâ”€â”€ auth/
â”‚       â”œâ”€â”€ events/
â”‚       â”œâ”€â”€ payments/
â”‚       â””â”€â”€ webhooks/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                # Componentes base (shadcn)
â”‚   â””â”€â”€ features/          # Componentes de feature
â”‚       â”œâ”€â”€ auth/
â”‚       â”œâ”€â”€ events/
â”‚       â””â”€â”€ payments/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ db.ts             # Prisma client
â”‚   â”œâ”€â”€ auth.ts           # JWT helpers
â”‚   â”œâ”€â”€ mercadopago.ts    # MP SDK wrapper
â”‚   â””â”€â”€ email.ts          # Resend wrapper
â”œâ”€â”€ types/                # TypeScript types
â””â”€â”€ utils/                # FunÃ§Ãµes auxiliares
```

### Nomenclatura
- **Componentes:** PascalCase (`EventCard.tsx`)
- **FunÃ§Ãµes:** camelCase (`createPayment()`)
- **Constantes:** UPPER_SNAKE_CASE (`MAX_UPLOAD_SIZE`)
- **Arquivos:** kebab-case (`user-profile.ts`)
- **Types/Interfaces:** PascalCase com `I` ou `T` prefix opcional

---

## ğŸ” VARIÃVEIS DE AMBIENTE

```bash
# Database
DATABASE_URL="postgresql://..."

# Auth
JWT_SECRET="..."
JWT_REFRESH_SECRET="..."
ENCRYPTION_KEY="..." # 32 bytes para AES-256

# Mercado Pago
MP_CLIENT_ID="..."
MP_CLIENT_SECRET="..."
MP_ACCESS_TOKEN="..." # Token da OkÃª Sports (receber split)
MP_PUBLIC_KEY="..."

# Email
RESEND_API_KEY="..."

# Storage
AWS_ACCESS_KEY_ID="..."
AWS_SECRET_ACCESS_KEY="..."
AWS_BUCKET_NAME="..."

# App
NEXT_PUBLIC_APP_URL="https://okesports.com.br"
NEXT_PUBLIC_API_URL="https://api.okesports.com.br"

# Monitoramento
SENTRY_DSN="..."
```

---

## ğŸ“Š MÃ‰TRICAS DE SUCESSO

### Checkpoint 1 (Semana 4 - MVP)
- [ ] 3-5 organizadores testando
- [ ] 1 evento real publicado
- [ ] 50+ inscriÃ§Ãµes processadas
- [ ] PIX + CartÃ£o 100% funcionais
- [ ] Taxa de sucesso pagamento > 95%

### Checkpoint 2 (MÃªs 3 - Crescimento)
- [ ] 10+ organizadores pagantes
- [ ] 5+ eventos simultÃ¢neos
- [ ] 200+ inscriÃ§Ãµes/mÃªs
- [ ] ConversÃ£o > 30%
- [ ] NPS > 40

### Checkpoint 3 (MÃªs 6 - Escala)
- [ ] 50+ organizadores ativos
- [ ] 20+ eventos/mÃªs
- [ ] 1.000+ inscriÃ§Ãµes/mÃªs
- [ ] GMV: R$ 50k+/mÃªs
- [ ] Churn < 10%

### Meta Ano 1
- [ ] 200+ organizadores
- [ ] 4-5k inscriÃ§Ãµes/mÃªs
- [ ] GMV: R$ 200-250k/mÃªs
- [ ] Receita OkÃª: R$ 10-12k/mÃªs
- [ ] Breakeven ou lucratividade

---

## ğŸš¨ DECISÃ•ES IMPORTANTES

### 1. Por que modelo Marketplace?
**DecisÃ£o:** Organizador conecta sua prÃ³pria conta do gateway (OAuth)
**Vantagem:**
- âœ… Zero risco financeiro para plataforma
- âœ… NÃ£o somos instituiÃ§Ã£o de pagamento
- âœ… Sem compliance bancÃ¡rio complexo
- âœ… Organizador recebe dinheiro direto
- âœ… Mais confianÃ§a do organizador

**Trade-off:**
- âŒ Requer onboarding do organizador (conectar MP)
- âŒ DependÃªncia do gateway (mas baixa - split nativo)

### 2. Por que Mercado Pago e nÃ£o Stripe?
**DecisÃ£o:** Mercado Pago como gateway principal
**Vantagem:**
- âœ… Split payment nativo
- âœ… PIX com taxa de 0,99% (Stripe: 1%)
- âœ… Reconhecimento de marca no Brasil
- âœ… Suporte em portuguÃªs
- âœ… DocumentaÃ§Ã£o completa

**Manter Stripe como backup para futuro**

### 3. Por que Next.js e nÃ£o separar front/back?
**DecisÃ£o:** Monolito Next.js no MVP
**Vantagem:**
- âœ… Mais rÃ¡pido de desenvolver
- âœ… SSR nativo (melhor SEO)
- âœ… API Routes integradas
- âœ… Deploy simplificado (Vercel)
- âœ… Type-safety full-stack

**Futuro:** Separar em microsserviÃ§os se necessÃ¡rio (escala)

### 4. Por que PIX + CartÃ£o no MVP?
**DecisÃ£o:** Incluir cartÃ£o de crÃ©dito desde o inÃ­cio (nÃ£o sÃ³ PIX)
**Vantagem:**
- âœ… Eventos esportivos custam R$ 80-300
- âœ… PÃºblico quer parcelar
- âœ… PIX sozinho limita vendas
- âœ… Mais credibilidade profissional

**Essential para mostrar valor real**

### 5. Por que Freemium e nÃ£o sÃ³ Split?
**DecisÃ£o:** Modelo freemium com planos
**Vantagem:**
- âœ… Reduz barreira de entrada (plano free)
- âœ… MRR previsÃ­vel (planos pagos)
- âœ… Upsell natural (limites free)
- âœ… SegmentaÃ§Ã£o de clientes

**Trade-off:**
- âŒ Complexidade adicional no cÃ³digo
- âŒ Precisa gerenciar limites/cotas

---

## ğŸ“š REFERÃŠNCIAS ÃšTEIS

### DocumentaÃ§Ã£o Principal
- **Mercado Pago Marketplace:** https://www.mercadopago.com.br/developers/pt/docs/mp-marketplace
- **Next.js 14:** https://nextjs.org/docs
- **Prisma:** https://www.prisma.io/docs
- **Resend:** https://resend.com/docs
- **shadcn/ui:** https://ui.shadcn.com

### InspiraÃ§Ã£o de UX
- **Ticket Sports:** referÃªncia de features (nÃ£o de preÃ§o)
- **Sympla:** checkout e busca de eventos
- **Eventbrite:** dashboard e relatÃ³rios

### Competitors
- Ticket Sports (principal)
- Sympla (eventos gerais)
- InscriÃ§ÃµesOnline (pequeno)
- Tottem (bÃ¡sico)

---

## ğŸ¨ DESIGN SYSTEM

### Paleta de Cores
```css
:root {
  --primary: #2563eb;      /* Blue - aÃ§Ãµes principais */
  --secondary: #10b981;    /* Green - sucesso, confirmaÃ§Ã£o */
  --danger: #ef4444;       /* Red - erros, cancelar */
  --warning: #f59e0b;      /* Orange - alertas */
  --gray: #6b7280;         /* Gray - textos secundÃ¡rios */
  --dark: #1f2937;         /* Dark gray - textos principais */
}
```

### Tipografia
- **Font:** Inter ou System Font (-apple-system)
- **Heading:** 600-700 weight
- **Body:** 400 weight
- **Small:** 300 weight

### Componentes Base (shadcn/ui)
- Button
- Input
- Card
- Badge
- Alert
- Dialog
- Dropdown Menu
- Table
- Tabs

---

## ğŸ› DEBUG TIPS

### Problemas Comuns

**1. Webhook nÃ£o funcionando localmente**
```bash
# Usar ngrok ou Mercado Pago Test Webhooks
ngrok http 3000
# Configurar URL no painel MP: https://xxx.ngrok.io/api/webhooks/mercadopago
```

**2. OAuth redirect loop**
```bash
# Verificar NEXT_PUBLIC_APP_URL estÃ¡ correto
# Verificar callback_url configurado no MP
```

**3. Pagamento nÃ£o aparece no dashboard**
```bash
# Verificar webhook chegou (logs)
# Verificar paymentId salvo corretamente na inscriÃ§Ã£o
# Verificar status do pagamento no Mercado Pago
```

**4. Erro de CORS**
```bash
# Adicionar em next.config.js:
async headers() {
  return [
    {
      source: '/api/:path*',
      headers: [
        { key: 'Access-Control-Allow-Origin', value: '*' }
      ]
    }
  ]
}
```

---

## ğŸ¤ COMO CONTRIBUIR

### Workflow
1. Pegar issue do GitHub (atribuir a si mesmo)
2. Criar branch: `git checkout -b feature/M1.1-nome`
3. Desenvolver + testes
4. Commit seguindo convenÃ§Ãµes
5. Push e abrir PR
6. Code review (mÃ­nimo 1 aprovaÃ§Ã£o)
7. Merge â†’ Deploy automÃ¡tico

### Code Review Checklist
- [ ] CÃ³digo segue convenÃ§Ãµes
- [ ] Testes passando
- [ ] TypeScript sem erros
- [ ] Sem console.logs deixados
- [ ] Tratamento de erros adequado
- [ ] DocumentaÃ§Ã£o atualizada (se necessÃ¡rio)

---

## ğŸ“ LINKS IMPORTANTES

### RepositÃ³rio
- **GitHub:** https://github.com/[usuario]/OkeSports

### Ambientes
- **Staging:** https://staging.okesports.com.br
- **ProduÃ§Ã£o:** https://okesports.com.br (futuro)

### Ferramentas
- **Figma:** [link do design]
- **Notion:** [link da documentaÃ§Ã£o]
- **Slack:** [link do workspace]

### Mercado Pago
- **Dashboard:** https://www.mercadopago.com.br/developers
- **Sandbox:** https://www.mercadopago.com.br/developers/panel/test-accounts

---

## ğŸ¯ FOCO ATUAL

**Status:** Criando estrutura inicial no GitHub
**Sprint Atual:** M0 (ValidaÃ§Ã£o de Mercado)
**PrÃ³xima Sprint:** M1 (Setup e Core MÃ­nimo)

**Meta desta semana:**
1. âœ… Finalizar planejamento (concluÃ­do!)
2. ğŸš§ Criar labels, milestones e issues no GitHub
3. ğŸ“… Definir data de kickoff do M0
4. ğŸ“… Preparar roteiro de entrevistas (M0)

---

## ğŸ’¡ DICAS PARA O CLAUDE

### Ao ajudar com cÃ³digo:
- Sempre usar TypeScript (nÃ£o JavaScript puro)
- Preferir Server Components no Next.js (usar 'use client' apenas quando necessÃ¡rio)
- Validar inputs com Zod
- Tratar erros com try/catch
- Retornar tipos corretos nas API routes
- Criptografar dados sensÃ­veis
- Adicionar comentÃ¡rios em lÃ³gicas complexas

### Ao criar componentes:
- Usar shadcn/ui como base
- Componentes pequenos e focados
- Props tipadas com TypeScript
- Acessibilidade (ARIA labels)
- Responsivo (mobile-first)

### Ao trabalhar com pagamentos:
- NUNCA expor access_token em logs
- Sempre validar assinatura de webhooks
- Tratar todos os status de pagamento
- IdempotÃªncia em webhooks (nÃ£o processar 2x)
- Usar sandbox do MP para testes

---

**Este arquivo Ã© atualizado automaticamente pelo Claude Code durante o desenvolvimento.**

**Ãšltima sincronizaÃ§Ã£o:** 31/10/2025
